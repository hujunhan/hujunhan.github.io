<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hujunhan.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Only Truth Matters">
<meta property="og:url" content="https://hujunhan.github.io/page/9/index.html">
<meta property="og:site_name" content="Only Truth Matters">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Junhan Hu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hujunhan.github.io/page/9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Only Truth Matters</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Only Truth Matters</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Hardware/BNO055/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Hardware/BNO055/" class="post-title-link" itemprop="url">IMU:BNO-055</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-12-22 00:07:00 / Modified: 00:14:29" itemprop="dateCreated datePublished" datetime="2022-12-22T00:07:00-08:00">2022-12-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>BNO-055 is a 9-DOF IMU that can output absolute orientation (a hard problem to solve)</p>
<ul>
<li>The fusion algorithm is in the chip already</li>
<li>Can output<ul>
<li>Absolute orientation (Quaterion)</li>
<li>Linear acceleration</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-22-00-13-15.jpg" alt="sensors_pinout.jpg"></p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>Communicate with a board by I2C&#x2F;IIC</p>
<ul>
<li>SDA: data</li>
<li>SCL: clock</li>
</ul>
<p>Check if the system detected </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Wire.h&gt;</span> <span class="comment">//include Wire.h library</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Wire.<span class="built_in">begin</span>(); <span class="comment">// Wire communication begin</span></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>); <span class="comment">// The baudrate of Serial monitor is set in 9600</span></span><br><span class="line">  <span class="keyword">while</span> (!Serial); <span class="comment">// Waiting for Serial Monitor</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;\nI2C Scanner&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  byte error, address; <span class="comment">//variable for error and I2C address</span></span><br><span class="line">  <span class="type">int</span> nDevices;</span><br><span class="line"></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;Scanning...&quot;</span>);</span><br><span class="line"></span><br><span class="line">  nDevices = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (address = <span class="number">1</span>; address &lt; <span class="number">127</span>; address++ )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// The i2c_scanner uses the return value of</span></span><br><span class="line">    <span class="comment">// the Write.endTransmisstion to see if</span></span><br><span class="line">    <span class="comment">// a device did acknowledge to the address.</span></span><br><span class="line">    Wire.<span class="built_in">beginTransmission</span>(address);</span><br><span class="line">    error = Wire.<span class="built_in">endTransmission</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (error == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      Serial.<span class="built_in">print</span>(<span class="string">&quot;I2C device found at address 0x&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (address &lt; <span class="number">16</span>)</span><br><span class="line">        Serial.<span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">      Serial.<span class="built_in">print</span>(address, HEX);</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;  !&quot;</span>);</span><br><span class="line">      nDevices++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (error == <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      Serial.<span class="built_in">print</span>(<span class="string">&quot;Unknown error at address 0x&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (address &lt; <span class="number">16</span>)</span><br><span class="line">        Serial.<span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">      Serial.<span class="built_in">println</span>(address, HEX);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (nDevices == <span class="number">0</span>)</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;No I2C devices found\n&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;done\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">5000</span>); <span class="comment">// wait 5 seconds for the next I2C scan</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The address should be 0x28</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>Use Adafruit library</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Hardware/ir-sensor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Hardware/ir-sensor/" class="post-title-link" itemprop="url">IR Remote</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-12-19 21:39:00 / Modified: 22:16:14" itemprop="dateCreated datePublished" datetime="2022-12-19T21:39:00-08:00">2022-12-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>IR use light to transmit data</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-19-21-39-27.png" alt="image-20221219213927203"></p>
<p>Light used is infrared</p>
<ul>
<li>inexpensive</li>
<li>subject to interference <ul>
<li>Sunlight would interference the IR</li>
</ul>
</li>
</ul>
<p>Data are modulated in 38K Hz (usually)</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-19-21-41-12.png" alt="image-20221219214112137"></p>
<p>Each button sends a unique code</p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="Sender"><a href="#Sender" class="headerlink" title="Sender"></a>Sender</h3><p>How to see if the controller works？</p>
<ul>
<li>Human eye can’t see the light</li>
<li>Camera can see it (phone)</li>
</ul>
<h3 id="Receiver"><a href="#Receiver" class="headerlink" title="Receiver"></a>Receiver</h3><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-19-22-16-09.png" alt="image-20221219221609056" style="zoom:33%;" />

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boarddefs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;IRremoteInt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ir_Lego_PF_BitStreamEncoder.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;IRremote.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> RECV_PIN = <span class="number">11</span>; <span class="comment">// the pin where you connect the output pin of IR sensor     </span></span><br><span class="line"><span class="function">IRrecv <span class="title">irrecv</span><span class="params">(RECV_PIN)</span></span>;     </span><br><span class="line">decode_results results;     </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line">Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);     </span><br><span class="line">irrecv.<span class="built_in">enableIRIn</span>();     </span><br><span class="line">&#125;     </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="keyword">if</span> (irrecv.<span class="built_in">decode</span>(&amp;results))<span class="comment">// Returns 0 if no data ready, 1 if data ready.     </span></span><br><span class="line">&#123;     </span><br><span class="line"> <span class="comment">//int value = results.value; ;// Results of decoding are stored in result.value     </span></span><br><span class="line"> Serial.<span class="built_in">println</span>(<span class="string">&quot; &quot;</span>);     </span><br><span class="line"> Serial.<span class="built_in">print</span>(<span class="string">&quot;Code: &quot;</span>);     </span><br><span class="line"> Serial.<span class="built_in">println</span>(results.value,HEX); <span class="comment">//prints the value a a button press     </span></span><br><span class="line"> Serial.<span class="built_in">println</span>(<span class="string">&quot; &quot;</span>);     </span><br><span class="line"> irrecv.<span class="built_in">resume</span>(); <span class="comment">// Restart the ISR state machine and Receive the next value     </span></span><br><span class="line">&#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Hardware/mpu6050/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Hardware/mpu6050/" class="post-title-link" itemprop="url">IMU:MPU6050</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-17 23:04:00" itemprop="dateCreated datePublished" datetime="2022-12-17T23:04:00-08:00">2022-12-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-18 00:02:08" itemprop="dateModified" datetime="2022-12-18T00:02:08-08:00">2022-12-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>MPU6050 is a IMU that can measure acceleration and orientation</p>
<p>This is part of the localization system, could be combined with encoder and lidar to provide robot a high-accuracy localization system</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-17-23-07-13.jpeg" alt="IMG_7084"></p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>Communicate with a board by I2C&#x2F;IIC</p>
<ul>
<li>SDA: data</li>
<li>SCL: clock</li>
</ul>
<p>Check if the system detected </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo i2cdetect -r -y 1</span><br><span class="line"><span class="comment">## output</span></span><br><span class="line">     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f</span><br><span class="line">00:          -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --</span><br><span class="line">60: -- -- -- -- -- -- -- -- 68 -- -- -- -- -- -- --</span><br><span class="line">70: -- -- -- -- -- -- -- --</span><br></pre></td></tr></table></figure>

<p>Which means the MPU6050’s address is 68</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># read_word and read_word_2c from http://blog.bitify.co.uk/2013/11/reading-data-from-mpu-6050-on-raspberry.html</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_word</span>(<span class="params">adr</span>):</span><br><span class="line">    high = bus.read_byte_data(ADDR, adr)</span><br><span class="line">    low = bus.read_byte_data(ADDR, adr+<span class="number">1</span>)</span><br><span class="line">    val = (high &lt;&lt; <span class="number">8</span>) + low</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_word_2c</span>(<span class="params">adr</span>):</span><br><span class="line">    val = read_word(adr)</span><br><span class="line">    <span class="keyword">if</span> (val &gt;= <span class="number">0x8000</span>):</span><br><span class="line">        <span class="keyword">return</span> -((<span class="number">65535</span> - val) + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line"><span class="comment"># Read the acceleration vals</span></span><br><span class="line">accel_x = read_word_2c(ACCEL_XOUT_H) / <span class="number">16384.0</span></span><br><span class="line">accel_y = read_word_2c(ACCEL_YOUT_H) / <span class="number">16384.0</span></span><br><span class="line">accel_z = read_word_2c(ACCEL_ZOUT_H) / <span class="number">16384.0</span></span><br><span class="line"><span class="comment"># Read the gyro vals</span></span><br><span class="line">gyro_x = read_word_2c(GYRO_XOUT_H) / <span class="number">131.0</span></span><br><span class="line">gyro_y = read_word_2c(GYRO_YOUT_H) / <span class="number">131.0</span></span><br><span class="line">gyro_z = read_word_2c(GYRO_ZOUT_H) / <span class="number">131.0</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/CS/Miscellaneous/Mount-in-linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/CS/Miscellaneous/Mount-in-linux/" class="post-title-link" itemprop="url">Mount Disk In Linux</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-12-16 00:40:00 / Modified: 00:45:16" itemprop="dateCreated datePublished" datetime="2022-12-16T00:40:00-08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/CS/Miscellaneous/" itemprop="url" rel="index"><span itemprop="name">Miscellaneous</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>Without network, the only way to copy file is through USB drive.</p>
<p>How to mount and copy file through command line?</p>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><ol>
<li><pre><code class="bash">sudo mkdir /media/usb
# create mount point
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. ```bash</span><br><span class="line">   sudo lsblk</span><br><span class="line">   # find out which device should mount</span><br></pre></td></tr></table></figure>

![image-20221216004405653](https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-16-00-44-05.png)
</code></pre>
</li>
<li><pre><code class="bash">sudo mount  /dev/sdb2 /media/usb -o uid=1000,gid=1000,utf8,dmask=027,fmask=137
# mount the right disk (large one) to the create mount point
</code></pre>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Control/Project/motor_control/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Control/Project/motor_control/" class="post-title-link" itemprop="url">Motor Control for Autonomous Robot</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-10 21:24:00" itemprop="dateCreated datePublished" datetime="2022-12-10T21:24:00-08:00">2022-12-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-13 22:29:31" itemprop="dateModified" datetime="2022-12-13T22:29:31-08:00">2022-12-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Control/" itemprop="url" rel="index"><span itemprop="name">Control</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Control/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><ol>
<li>Identity the behavior of the object to be controlled.<ol>
<li>In theory, analyze the response, the more linear, the easier to control</li>
</ol>
</li>
<li>Design Controller</li>
<li>Check the result and tune</li>
</ol>
<h2 id="Behavior"><a href="#Behavior" class="headerlink" title="Behavior"></a>Behavior</h2><p>Collect the data by giving the motor PWM from 0 to 255, record the RPM and see whats going on</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-10-21-40-34.png" alt="image-20221210214034055"></p>
<p>We can see that the relation is almost linear</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-10-22-52-30.png" alt="image-20221210225230532"></p>
<p>So we can fit the data<br>$$<br>RPM&#x3D;0.88PWM-8.1<br>$$<br>Above is the data from right motor, things in left motor is similar</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-10-23-28-29.png" alt="image-20221210232829155"></p>
<p>However, the coef is a little different<br>$$<br>RPM&#x3D;0.86PWM-5.99<br>$$<br>Maybe two reason</p>
<ol>
<li>Error introduced while manufacturing the two motor</li>
<li>Error while installing the two motor</li>
</ol>
<h3 id="Response-Time"><a href="#Response-Time" class="headerlink" title="Response Time"></a>Response Time</h3><p>We need to see how quickly the encoder can calculate a accurate RPM</p>
<p>How much pulse the system need? We need to be accurate in slowest situation</p>
<p>From the data, the RPM start to be normal from 10 RPM while given PWM around 20.</p>
<p>Let’s see 10RPM, means 10&#x2F;60 per seconds, times 187, around 30 pulse, not enough, if we use both RISING and FALLING signal and use two signal, it would be around 120 pulse in a second, then 200ms (24 count) would be enough.</p>
<p>Conclusion: 200ms (4% error max), 100ms (10% error max)</p>
<p>Use 100ms </p>
<h3 id="PID"><a href="#PID" class="headerlink" title="PID"></a>PID</h3><ol>
<li>Add fraction, the RPM should be smaller</li>
<li>We need to increase PWM to maintain the desired RPM</li>
</ol>
<p>Say the working speed at 0.2m&#x2F;s<br>$$<br>v&#x3D;2\pi \times r\times\frac{RPM}{60}\<br>RPM&#x3D;\frac{60v}{2\pi \times r}<br>$$<br>The $r$ here is 0.06m, so RPM should be $\frac{60\times 0.2}{2*\times 3.14\times 0.06}&#x3D;31.8$</p>
<p>Let’s see how much PWM we should give to motor?</p>
<ul>
<li>For right motor,(31.8+8.1)&#x2F;0.88&#x3D;45</li>
<li>For left motor, (31.8+5.99)&#x2F;0.86&#x3D;44</li>
</ul>
<p>Be generous, just use the 45</p>
<p>In the experiments, we can see that while the PWM is 45, the RPM should be around 33 without load.</p>
<p>By giving a fraction (holding a book on the wheel), the RPM is 23</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Hardware/encoder/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Hardware/encoder/" class="post-title-link" itemprop="url">Encoder</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-06 21:45:00" itemprop="dateCreated datePublished" datetime="2022-12-06T21:45:00-08:00">2022-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-07 23:39:12" itemprop="dateModified" datetime="2022-12-07T23:39:12-08:00">2022-12-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>Usage</p>
<ol>
<li>Active, can be used as motor controller, like a physical button to tell the system how much speed&#x2F;volume you want</li>
<li>Passive, can be used as a motor sensor, reading the rotation of a motor, can be further calculated as angular speed</li>
</ol>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-06-21-53-55.png" alt="image-20221206215355653"></p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>Typically, the encoder on a motor would have 4 channel,</p>
<ul>
<li>VCC: in general, 5V</li>
<li>GND: ground</li>
<li>ChA and ChB, two channel of the encoder that output PWM<ul>
<li>two channel can be used at same time to determine the direction of motor</li>
<li>In reality, only ONE channel is enough since the direction is controlled by the controller (us)</li>
</ul>
</li>
</ul>
<h2 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h2><p>Resolution need to be known to calculate the speed</p>
<h3 id="PPR"><a href="#PPR" class="headerlink" title="PPR"></a>PPR</h3><p>Pulses Per Revolution</p>
<p>Describe the number of high pulse an encoder will have over a single revolution</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-07-21-53-12.png" alt="image-20221207215312381"></p>
<h3 id="CPR"><a href="#CPR" class="headerlink" title="CPR"></a>CPR</h3><p>Counts Per Revolution</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-07-21-52-55.png" alt="image-20221207215255380"></p>
<h2 id="Datasheet"><a href="#Datasheet" class="headerlink" title="Datasheet"></a>Datasheet</h2><p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-07-23-32-25.png" alt="image-20221207233224754"></p>
<p>Gearbox output shaft shows 751.8, but when I rotate the wheel for a revolution, the encoder increased by around 180, what’s wrong?</p>
<ul>
<li><p>There are two channel A&#x2F;B</p>
</li>
<li><p>Each square wave would have two pulse (although only one is rising)</p>
</li>
<li><p>So 751.8&#x2F;4&#x3D;187.95, that’s right :white_check_mark:</p>
<p><a target="_blank" rel="noopener" href="https://www.reddit.com/r/FTC/comments/aity1l/how_many_encoder_pulses_in_a_gobilda_motor/">Ref</a></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Project/battery-localization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Project/battery-localization/" class="post-title-link" itemprop="url">Battery Localization</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-04 23:03:00" itemprop="dateCreated datePublished" datetime="2022-12-04T23:03:00-08:00">2022-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-05 00:15:56" itemprop="dateModified" datetime="2022-12-05T00:15:56-08:00">2022-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>矿山电池定位系统</p>
<p>目标：使用多相机多角度视觉系统，定位电池的3d位置</p>
<p>描述：</p>
<ol>
<li>多个相机拍摄电池的不同位置</li>
<li>将信息组合，列公式或者</li>
<li>推算出相机相对于电池的位置</li>
</ol>
<p>算法：</p>
<ul>
<li>输入：多张图片</li>
<li>输出：相对位姿</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Life/Things/poem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Life/Things/poem/" class="post-title-link" itemprop="url">诗歌</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-12-03 18:07:00" itemprop="dateCreated datePublished" datetime="2022-12-03T18:07:00-08:00">2022-12-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 20:52:21" itemprop="dateModified" datetime="2023-02-08T20:52:21-08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Life/Things/" itemprop="url" rel="index"><span itemprop="name">Things</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="诗歌"><a href="#诗歌" class="headerlink" title="诗歌"></a>诗歌</h2><p>我最早接触诗应该是在很小的时候，还在府庙的湖师附小。起因大概是语文老师有一次布置了诗歌的作业，让我们写诗，然后在班级里挑选了几个同学，参加什么诗歌的讨论组，小灶班？印象特别深的是参加这个讨论组应该是在周五，因为想到这件事，我仍能回忆起当时的开心，要不就是周五，要不就是能翘掉课，反正让人欣喜。</p>
<p>我已经无法想起我为什么会被选中，讨论组又究竟讨论了什么，只记得有一次讨论组布置了作业，我忘了写，于是在讨论之前几分钟随手写了几句，最后还被老师表扬了。大概是这样的：</p>
<blockquote>
<p>秋天就像这片纸，</p>
<p>钻进了火里，</p>
<p>什么都没留下，</p>
<p>只留下了一缕烟尘</p>
</blockquote>
<p>因为当时时间紧迫，我甚至没带纸，可能是找同学的本子撕了一小片纸写下来（这样的剧情在我的学生生涯中发生了许多许多次）</p>
<h2 id="审视"><a href="#审视" class="headerlink" title="审视"></a>审视</h2><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=08ZWROqoTZo">Ref</a></p>
<p>诗歌，或者说文字，也是人理解世界的一种方式。虽然我习惯用数字和物理去理解世界，但我相信，不同的理解方式能带给我新的认知</p>
<p>哲学，在希腊语中是爱智慧；诗，在希腊语中是被创造之物</p>
<p>诗歌的独特之处，诗歌易于分享，带有想象。</p>
<p>Pattern, Word, Feeling,</p>
<p>也有可能令人困惑，我们如何解释诗歌，我们如何知道自己的解释是否正确？永远无法知道，但无所谓，也没有什么坏处</p>
<ul>
<li>六经注我之困境，我们所阅读的文字，所反映出的，只能我们自己的内心</li>
<li>另一种可能：去体会和我们完全不一样的人，所感受的世界是怎么样的，</li>
</ul>
<p>幼年的我，写诗，写的是缥缈的思绪</p>
<p>成年的我，读诗，读的是别人的世界</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Hardware/lidar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Hardware/lidar/" class="post-title-link" itemprop="url">LiDAR In Robots</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-12-03 01:06:00 / Modified: 01:19:17" itemprop="dateCreated datePublished" datetime="2022-12-03T01:06:00-08:00">2022-12-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Hardware/" itemprop="url" rel="index"><span itemprop="name">Hardware</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>Lidar is important for mobile robot to achieve the obstacle avoidance and navigation system</p>
<h2 id="How-it-Works"><a href="#How-it-Works" class="headerlink" title="How it Works"></a>How it Works</h2><p>Light Detection And Ranging</p>
<p>Determined by the travel time to calculate the distance</p>
<hr>
<p>Lidar works great indoor and outdoor</p>
<p>Ultrasonic is great for indoor use only, and the sensor would be very noisy for some object</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Project/mobile-robot-i/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Project/mobile-robot-i/" class="post-title-link" itemprop="url">Build A Mobile Robot from Scratch —— Part I</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-12 16:46:00" itemprop="dateCreated datePublished" datetime="2022-11-12T16:46:00-08:00">2022-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-30 11:10:28" itemprop="dateModified" datetime="2022-12-30T11:10:28-08:00">2022-12-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>Why this project? I wanna build a robot from scratch to fill the gap between theory and reality.</p>
<p>To build the robot, usually need following knowledge base</p>
<ul>
<li>Mechanics, the build the body of robot</li>
<li>Electronic, the power of the robot</li>
<li>Computer, the brain of the robot</li>
</ul>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>For the robot, I would like to focus on the mobile robot platform</p>
<p>Two level goals:</p>
<ol>
<li>Basic level, the robot can move, and use the lidar as a SLAM  sensor, can track something using camera</li>
<li>More precise control, going from A to B, the error should be less than 1cm</li>
</ol>
<p>Consider a layer platform</p>
<ol>
<li>Environment sensing, different sensor to be used, a SBC is used. LiDAR, video camera, speaker, microphone</li>
<li>Intelligence, communication, SBC, control other part</li>
<li>Navigation, get the high-level command and go to desired position</li>
</ol>
<p>Communication Ethernet</p>
<h2 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h2><p>Motor</p>
<ul>
<li>Control how it works</li>
<li>feedback control</li>
<li>position control</li>
<li>speed control</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-13-15-44-30.png" alt="image-20221113154430236"></p>
<h2 id="Chassis"><a href="#Chassis" class="headerlink" title="Chassis"></a>Chassis</h2><p>Design</p>
<p>34cm  30cm  23cm</p>
<p>Front x2</p>
<p>Rear x2</p>
<h2 id="New-Thing"><a href="#New-Thing" class="headerlink" title="New Thing"></a>New Thing</h2><h3 id="Motor-Driver"><a href="#Motor-Driver" class="headerlink" title="Motor Driver"></a>Motor Driver</h3><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ygrsIqWOh3Y">Ref</a></p>
<p>Working with DC motor</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-13-19-40-18.png" alt="image-20221113194018459"></p>
<ul>
<li>Direction<ul>
<li>Using the H-bridge could change the direction of voltage and current</li>
<li>MOSFET would drop a little voltage</li>
</ul>
</li>
<li>Speed<ul>
<li>PWM</li>
</ul>
</li>
</ul>
<p>L298N, simple, classic but too old</p>
<p>More improved design:</p>
<ul>
<li>TB6612FNG, improved version of L298N</li>
<li>DRV8871, if you only need a SINGLE motor to drive</li>
<li>MX1508, small, but not soldering friendly</li>
</ul>
<p>Driver that can handle large current:</p>
<ul>
<li>DBH-12，20A, peak 30A</li>
<li>IBT2, single channel, 30A, peak 43A</li>
</ul>
<h3 id="Micro-Controller"><a href="#Micro-Controller" class="headerlink" title="Micro Controller"></a>Micro Controller</h3><p>UNO or raspberry pi PICO</p>
<p>Pico should be a better choice in 2022 (introduced in 2021)</p>
<ul>
<li>Much faster (133MHz vs 16MHz)</li>
<li>Much larger RAM</li>
<li>Lower power DC (1.8v-5.5v)</li>
<li>More port (Analog and Digital)</li>
</ul>
<h3 id="Battery"><a href="#Battery" class="headerlink" title="Battery"></a>Battery</h3><p>LIPO battery, high capacity in lightweight</p>
<p>Con: easily damaged</p>
<p>Lithium-Ion Polymer (锂离子聚合物电池)</p>
<ul>
<li>Application where weight matters</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-14-15-29-46.png" alt="image-20221114152946679"></p>
<p>Each cell can provide 3.7V</p>
<ul>
<li>Fully charged 4.4V</li>
<li>Minimum safe charge is 3.0V</li>
</ul>
<p>Different wire</p>
<ul>
<li>S- serial</li>
<li>P- Parallel</li>
</ul>
<p>Capacity</p>
<ul>
<li>C rating</li>
</ul>
<p>Connection:</p>
<ul>
<li>Dean</li>
<li>XT60</li>
<li>EC3</li>
</ul>
<h3 id="Base-Material"><a href="#Base-Material" class="headerlink" title="Base Material"></a>Base Material</h3><p>Consider: strength to weight</p>
<p>Aluminum</p>
<ul>
<li>lightweight</li>
</ul>
<p>Acrylic (亚克力)</p>
<ul>
<li>lightweight</li>
<li>drilled</li>
</ul>
<h3 id="Channeling-System"><a href="#Channeling-System" class="headerlink" title="Channeling System"></a>Channeling System</h3><p>Actobotics system: good availablity</p>
<p><strong><a target="_blank" rel="noopener" href="https://www.gobilda.com/structure/">GoBilda system</a>:</strong> good quality, successor to the Actobotics</p>
<p>Vex system</p>
<p>Lynxmotion</p>
<h3 id="Motor-Selection"><a href="#Motor-Selection" class="headerlink" title="Motor Selection"></a>Motor Selection</h3><p>DC Gear motor</p>
<ul>
<li>Planetary: a bit expensive, but quiet</li>
<li>Spur: cheap, but noise</li>
</ul>
<p>Things to consider</p>
<ul>
<li><p>Nominal voltage, optimal voltage</p>
</li>
<li><p>No Load RPM, when nothing connected, what is the RPM</p>
</li>
<li><p>Stall torque and current. Newton Meter</p>
<ul>
<li>Stall: no more move</li>
<li>&lt;30% stall point</li>
</ul>
</li>
<li><p>Size and shaft</p>
<ul>
<li>Mount</li>
<li>Shaft may not in the center</li>
</ul>
</li>
</ul>
<p>Encoder is important</p>
<p>We need to first determine the </p>
<ul>
<li>Weight (Load)</li>
<li>Speed<ul>
<li>Longest working area for the robot</li>
<li>The robot should be slower than human walking (safe to control the robot)</li>
</ul>
</li>
</ul>
<p>Calculate the required specification for the motor and battery</p>
<p><a target="_blank" rel="noopener" href="https://community.robotshop.com/blog/show/drive-motor-sizing-tool">Calculator</a></p>
<p>Motor, hub, bearing, encoder</p>
<ul>
<li><strong>Bearing</strong> is quite important since the whole load is on the wheel<ul>
<li>if there are no bearings, the motor would load all the pressure</li>
</ul>
</li>
</ul>
<h3 id="Wheel"><a href="#Wheel" class="headerlink" title="Wheel"></a>Wheel</h3><p>Parameter for wheel:</p>
<ul>
<li>Wheel size, determine the speed</li>
<li>Wheel width, determine the traction and maximum load</li>
<li>Wheel traction, determine the surface robot can travel</li>
<li>Wheel type, determine the degree of movement</li>
</ul>
<p>Type</p>
<ul>
<li>Standard, most common, wide range size, can be used as driver or idler<ul>
<li>two degree (forward and backward)</li>
</ul>
</li>
<li>Caster and Ball wheel, orientable, use as idler, most used for indoor design</li>
<li>Mecanum, different left and right wheels, multi-drirectional, 45 degree roller</li>
<li>Omni wheels, 90 degree roller, 4 degree of freedom, best for indoor</li>
</ul>
<p>Arrangement</p>
<p>Durometer</p>
<ul>
<li>harder or softer？</li>
<li>30A maybe too soft</li>
</ul>
<h3 id="Electronics"><a href="#Electronics" class="headerlink" title="Electronics"></a>Electronics</h3><p>Motor driving</p>
<p>Power distribution board</p>
<p>Motor controller</p>
<p>Fuses: (保险丝)</p>
<ul>
<li><p>if the current is too big, would case heat, may lead fire</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-15-21-13-17.png" alt="image-20221115211317451"></p>
</li>
</ul>
<h3 id="Power-Source"><a href="#Power-Source" class="headerlink" title="Power Source"></a>Power Source</h3><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=IT19dg73nKU">Ref</a></p>
<p>Regulator and Convertor</p>
<p>Logic voltage, 5V(4.7-5.2), 3.3V. </p>
<p>Motor: 6V, 12V</p>
<hr>
<p>AC:</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-17-23-29-08.png" alt="image-20221117232907848"></p>
<hr>
<p>DC:</p>
<ul>
<li>From high to low:<ul>
<li>voltage regulation，AMS1117-5(much lower voltage drop), 1A</li>
<li>buck converter, high-efficient, mini360</li>
</ul>
</li>
<li>From low to high<ul>
<li>boost converter, PSM205, to a usb</li>
</ul>
</li>
<li>From any to any<ul>
<li>Buck boost converter, S9V11F5 (from 2-16 to 5)</li>
</ul>
</li>
</ul>
<h3 id="Motor-Controller"><a href="#Motor-Controller" class="headerlink" title="Motor Controller"></a>Motor Controller</h3><h3 id="Weight-Consideration"><a href="#Weight-Consideration" class="headerlink" title="Weight Consideration"></a>Weight Consideration</h3><p>If the robot is too lightweight, there would be not enough traction for the robot to move.</p>
<h3 id="Connector"><a href="#Connector" class="headerlink" title="Connector"></a>Connector</h3><p>JST</p>
<h2 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a>BOM</h2><table>
<thead>
<tr>
<th>Part</th>
<th>Name</th>
<th>Num</th>
<th>Check</th>
</tr>
</thead>
<tbody><tr>
<td>Front wheel</td>
<td>Motor</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>120mm Wheel</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>8mm REX bearing</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>8mm Face bearing</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>8mm shim</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>m4 washer</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>Hyper Hub</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>12mm M4 screw</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>Front wheel</td>
<td>18mm M4 screw</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Omni-wheel"><a href="#Omni-wheel" class="headerlink" title="Omni wheel"></a>Omni wheel</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Num</th>
<th>Check</th>
</tr>
</thead>
<tbody><tr>
<td>Omni wheels</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>Spacer 4mm</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>6mm D shaft hub</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>6mm D shaft bearing</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>6mm Collar</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>30mm M4 screw</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>80mm 6mm D-shaft</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Progress"><a href="#Progress" class="headerlink" title="Progress"></a>Progress</h2><p>11.21</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-11-21-23-12-05.png" alt="image-20221121231205713"></p>
<p>12.5 Test Robot Motor</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Full Speed</li>
<li><input checked="" disabled="" type="checkbox"> Arduino PWM<ul>
<li><input checked="" disabled="" type="checkbox"> 20%</li>
<li><input checked="" disabled="" type="checkbox"> 50%</li>
<li><input checked="" disabled="" type="checkbox"> 100%</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Encoder<ul>
<li><input checked="" disabled="" type="checkbox"> Each rotation</li>
</ul>
</li>
</ul>
<p>TODO:</p>
<ul>
<li>Add a ferrule crimping tool kit</li>
</ul>
<hr>
<p>Motor Driver:</p>
<p>VCC is connected to 5V power supply of MCU,GND is connected to GND of MCU.</p>
<p>R_EN AND L_EN short circuit and input PWM signal for speed regulation</p>
<p>L_PWM,pin input 5V level,motor forward</p>
<p>R_PWM,pin input 5V level,motor reversal</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="comment">// put your setup code here, to run once:</span></span><br><span class="line">  pinMode(<span class="number">8</span>,OUTPUT);</span><br><span class="line">  pinMode(<span class="number">7</span>,OUTPUT);</span><br><span class="line">  digitalWrite(<span class="number">8</span>, HIGH);</span><br><span class="line">  digitalWrite(<span class="number">7</span>, HIGH);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//PWM output</span></span><br><span class="line">  pinMode(<span class="number">6</span>,OUTPUT);</span><br><span class="line">  pinMode(<span class="number">5</span>,OUTPUT);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="comment">// put your main code here, to run repeatedly:</span></span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">50</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">100</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">150</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">200</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">255</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">50</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">100</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">150</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">200</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">255</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">  analogWrite(<span class="number">6</span>, <span class="number">0</span>);</span><br><span class="line">  delay(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Update-Dec-10"><a href="#Update-Dec-10" class="headerlink" title="Update Dec.10"></a>Update Dec.10</h3><p>Currently the robot works great on open-loop rotate and move forward, backward</p>
<p>Next</p>
<ol>
<li>Close-loop control on the RPM</li>
</ol>
<p>Test how linear the motor is. That is the relation between the PWM  duty rate and the RPM </p>
<h3 id="Update-Dec-13"><a href="#Update-Dec-13" class="headerlink" title="Update Dec.13"></a>Update Dec.13</h3><p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-13-22-33-45.png" alt="image-20221213223345245"></p>
<p>Re-organize the wire and hide the wire in the alumni channel</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-13-22-33-58.png" alt="image-20221213223358163"></p>
<p>Currently the robot’s speed control is under PID control</p>
<p>To make the position control closed-loop, still need encoder+IMU</p>
<p>And localization system should be added (SLAM)</p>
<h3 id="Update-Dec-15"><a href="#Update-Dec-15" class="headerlink" title="Update Dec.15"></a>Update Dec.15</h3><p>Use DC jack to power the Jetson and Arduino</p>
<p>Given the hardware and electronic elements I have, followed step</p>
<ul>
<li><del>Arduino Remote Control</del></li>
<li><del>Jetson use</del><ul>
<li><del>Communicate with computer</del></li>
<li><del>Setup wifi enable remote access</del></li>
<li><del>Read IMU data</del></li>
<li><del>Install Lidar and read lidar data</del></li>
</ul>
</li>
</ul>
<h3 id="Update-Dec-17"><a href="#Update-Dec-17" class="headerlink" title="Update Dec.17"></a>Update Dec.17</h3><ol>
<li><del>Rewire the arduino</del></li>
<li><del>Power Arduino with Jetson Nano</del></li>
<li><del>Communicate between arduino and jetson nano</del></li>
</ol>
<h3 id="Update-Dec-19"><a href="#Update-Dec-19" class="headerlink" title="Update Dec.19"></a>Update Dec.19</h3><p><del>Add IR remote in arduino</del></p>
<p>TODO:</p>
<ul>
<li><del>Remote control move forward&#x2F;reverse&#x2F;rotate</del></li>
<li>Use the lidar to build the map</li>
</ul>
<h3 id="Update-Dec-21"><a href="#Update-Dec-21" class="headerlink" title="Update Dec.21"></a>Update Dec.21</h3><p>Remote speed control and stop done</p>
<img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/2022-12-21-22-36-18.png" alt="image-20221221223618322" style="zoom: 15%;" />

<p>TODO:</p>
<ul>
<li>Add IMU<ul>
<li><del>Wire</del></li>
<li><del>Read data</del></li>
<li><del>Calibrate</del></li>
<li><del>Store offset</del></li>
<li><del>Reload offset</del></li>
</ul>
</li>
<li>3D print a level for lidar</li>
<li>SLAM</li>
</ul>
<h2 id="Takeout"><a href="#Takeout" class="headerlink" title="Takeout"></a>Takeout</h2><p>Low frequency PWM would cause the motor hauling, by increasing the frequency (like 3k) the hauling would disappear. In some MCU, by playing with the register, we might change the default frequency. </p>
<p>While selecting the MCU, checkout how many interrupt are needed and how many interrupt can the MCU provide.</p>
<p>By using encoder’s both channel and both rising and falling, we can maximize the accuracy of the motor</p>
<p>A good motor is almost linear between RPM and PWM</p>
<p>When the code doesn’t go well, check the setting and setup</p>
<p>After rewiring, double check the position especially the pin number</p>
<p>While making the wire, the length or wire should be considered. It’s a system design, so leave some room for wiring but not too much</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Junhan Hu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">330</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">115</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hujunhan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hujunhan" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hujunhan98@outlook.com" title="E-Mail → mailto:hujunhan98@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junhan Hu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
