<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hujunhan.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Only Truth Matters">
<meta property="og:url" content="https://hujunhan.github.io/page/4/index.html">
<meta property="og:site_name" content="Only Truth Matters">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Junhan Hu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hujunhan.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Only Truth Matters</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Only Truth Matters</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/CS/Miscellaneous/lib/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/CS/Miscellaneous/lib/" class="post-title-link" itemprop="url">Dynamic? Static?</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-03-08 22:32:00 / Modified: 23:39:14" itemprop="dateCreated datePublished" datetime="2023-03-08T22:32:00-08:00">2023-03-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/CS/Miscellaneous/" itemprop="url" rel="index"><span itemprop="name">Miscellaneous</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>Understand the difference between dynamic and static libraries in software</p>
<ul>
<li>Static: link at compile time, make the final program larger</li>
<li>Dynamic: link at runtime, require the system to have the lib</li>
</ul>
<p>When to use?</p>
<ul>
<li>Static: lib is small, not change, need to be optimized</li>
<li>Dynamic: lib is large, frequently update</li>
</ul>
<h2 id="Compile-Process"><a href="#Compile-Process" class="headerlink" title="Compile Process"></a>Compile Process</h2><ul>
<li>Preprocessing, remove comments, expand macro</li>
<li>Compilation, translate into assembly</li>
<li>Assembly, translatie into machine code</li>
<li>Linking, combine it with other libraries and modules</li>
</ul>
<h2 id="Linking"><a href="#Linking" class="headerlink" title="Linking?"></a>Linking?</h2><ul>
<li>Static linking is usually used for local</li>
<li>Dynamic linking is usually used for external libraries</li>
</ul>
<p>How it works?</p>
<ul>
<li>When compiled, it split into object file and combined into a single file</li>
<li>Header files should be used to make sure the parameter is correct</li>
</ul>
<p>References?</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/SLAM/aloam/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/SLAM/aloam/" class="post-title-link" itemprop="url">ALOAM Learning</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-07 21:15:00" itemprop="dateCreated datePublished" datetime="2023-03-07T21:15:00-08:00">2023-03-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-08 21:43:45" itemprop="dateModified" datetime="2023-03-08T21:43:45-08:00">2023-03-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/SLAM/" itemprop="url" rel="index"><span itemprop="name">SLAM</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>Understanding the overall structure of the LOAM project and try to compile it <strong>without</strong> ROS</p>
<h2 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h2><p>Paper: <a target="_blank" rel="noopener" href="http://www.roboticsproceedings.org/rss10/p07.pdf">Lidar Odometry and Mapping in Real-time</a></p>
<p><a target="_blank" rel="noopener" href="https://lukeyalvin.site/archives/43.html">Explanation</a></p>
<p>Problem: error in motion estimation cause mis-registration</p>
<p>Solution: propose 2 odometry</p>
<ul>
<li>High frequency, low accuracy</li>
<li>Low frequency, high accuracy</li>
</ul>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230307215625.png" alt="image-20230307215625066"></p>
<p>Some key point</p>
<ul>
<li><p>feature extraction: based on curvature, only a(A) is considered as a good feature point</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230307220111.png" alt="image-20230307220110995"></p>
<ul>
<li>Only a few feature point in a location (avoid density in-balance)</li>
<li>Can’t on the parallel surface and blocked area</li>
</ul>
</li>
<li><p>Need to deal with the distortion (since the robot is moving)</p>
</li>
<li><p>Find the matching</p>
<ul>
<li>Goal: minimize the distance (point to line and point to surface)<ul>
<li>$d_{\xi}&#x3D;\frac{|(\tilde{X}^L_{(k+1,i)}-\overline{X}^L_{(k,j)})×(\tilde{X}^L_{(k+1,i)}-\overline{X}^L_{(k,l)})|}<br>{|\overline{X}^L_{(k,j)}-\overline{X}^L_{(k,l)}|}. \tag{2}$</li>
<li>$d_\mathcal{H}&#x3D;\frac<br>{\begin{vmatrix}<br>(\tilde{X}^L_{(k+1,i)}-\overline{X}^L_{(k,j)})·((\overline{X}^L_{(k,j)}-\overline{X}^L_{(k,l)})×(\overline{X}^L_{(k,j)}-\overline{X}^L_{(k,m)}))<br>\end{vmatrix}<br>}<br>{\begin{vmatrix}<br>(\overline{X}^L_{(k,j)}-\overline{X}^L_{(k,l)})×(\overline{X}^L_{(k,j)}-\overline{X}^L_{(k,m)})<br>\end{vmatrix} }.$</li>
</ul>
</li>
</ul>
</li>
<li><p>Movement: linear interpolation</p>
</li>
<li><p>Building the Map: using the existing map to correct the movement estimation</p>
<ul>
<li>Since computation complex, so low frequency (1&#x2F;10 of the odometry)</li>
<li>Correct the whole map</li>
</ul>
</li>
</ul>
<h2 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h2><ul>
<li><p>PCL</p>
<ul>
<li><p>VTK</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">brew edit vtk</span><br><span class="line"><span class="comment">#https://stackoverflow.com/questions/3939651/how-do-i-modify-a-homebrew-formula</span></span><br><span class="line"><span class="comment">## Add two line</span></span><br><span class="line">      -DVTK_MODULE_ENABLE_VTK_GuiSupportQt:STRING=YES</span><br><span class="line">      -DVTK_MODULE_ENABLE_VTK_ViewsQt:STRING=YES</span><br><span class="line">brew reinstall --build-from-source --formula /opt/homebrew/Library/Taps/homebrew/homebrew-core/Formula/vtk.rb</span><br><span class="line"><span class="built_in">export</span> CMAKE_PREFIX_PATH=/opt/homebrew/Cellar/qt@5/5.15.8_2/</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>gtsam</p>
</li>
<li><p>Ceres-solver</p>
</li>
</ul>
<h2 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Life/Learning/hair/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Life/Learning/hair/" class="post-title-link" itemprop="url">人类毛发疑惑</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-03-07 00:15:00 / Modified: 00:26:36" itemprop="dateCreated datePublished" datetime="2023-03-07T00:15:00-08:00">2023-03-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Life/Learning/" itemprop="url" rel="index"><span itemprop="name">Learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ul>
<li>为什么头发没有在进化过程中减少</li>
<li>为什么头发会一直生长而其他毛发不会</li>
</ul>
<h2 id="头发？"><a href="#头发？" class="headerlink" title="头发？"></a>头发？</h2><p>头发比较重要</p>
<ul>
<li>保护，吸收紫外线</li>
<li>维持体温，大脑比较重要，且散热较多</li>
<li>社交信号</li>
</ul>
<h2 id="生长？"><a href="#生长？" class="headerlink" title="生长？"></a>生长？</h2><p>生物结构不一样</p>
<ul>
<li>头皮的毛囊更大，生长周期较长</li>
<li>其他部位毛发生长数月，就会停止生长</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/SLAM/liosam_problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/SLAM/liosam_problem/" class="post-title-link" itemprop="url">Problem Calibrating Lidar and IMU</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-06 00:51:00" itemprop="dateCreated datePublished" datetime="2023-03-06T00:51:00-08:00">2023-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-31 00:43:14" itemprop="dateModified" datetime="2023-03-31T00:43:14-07:00">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/SLAM/" itemprop="url" rel="index"><span itemprop="name">SLAM</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>硬件：</p>
<ul>
<li>雷神雷达C16<ul>
<li>16线</li>
<li>每线2000点</li>
</ul>
</li>
<li>北斗星通MS-6111 六轴IMU<ul>
<li>xyz加速度</li>
<li>角速度</li>
</ul>
</li>
</ul>
<p>软件</p>
<ul>
<li>校准：<a target="_blank" rel="noopener" href="https://github.com/chennuo0125-HIT/lidar_imu_calib">lidar_imu_calib</a><ul>
<li>开启雷达和IMU的ros节点</li>
<li>rosbag记录，同时移动雷达和IMU</li>
<li>计算IMU和雷达之间的位姿转换矩阵（只计算旋转）</li>
</ul>
</li>
<li>SLAM：<a target="_blank" rel="noopener" href="https://github.com/YJZLuckyBoy/liorf">liorf</a><ul>
<li>LIO-SAM的变种，可以接收六轴传感器</li>
</ul>
</li>
</ul>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>SLAM能够正常启动和运行，但是里程计会漂移，有很大的误差</p>
<img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230329185739.png" alt="image-20230329185739433" style="zoom: 50%;" />

<p>观察到的现象</p>
<ul>
<li>在平地时，IMU数据的x,y均有值。0.1m&#x2F;s^2左右</li>
<li>里程计显示速度越来越快</li>
</ul>
<h2 id="猜测原因"><a href="#猜测原因" class="headerlink" title="猜测原因"></a>猜测原因</h2><ul>
<li>雷达和imu校准不准确，算出来的矩阵有问题</li>
<li>由于雷达和imu频率不同导致的同步问题</li>
<li>imu没有调平</li>
</ul>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><ol>
<li>IMU内参标定</li>
<li>IMU和雷达外参标定</li>
<li>调平</li>
<li>时间戳同步</li>
<li>排查静止时输入到前段的数据，如点云，测距精度，噪声，频率，时间戳</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/SLAM/lidar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/SLAM/lidar/" class="post-title-link" itemprop="url">Lidar SLAM System Review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-06 00:51:00" itemprop="dateCreated datePublished" datetime="2023-03-06T00:51:00-08:00">2023-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-10 17:39:42" itemprop="dateModified" datetime="2023-03-10T17:39:42-08:00">2023-03-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/SLAM/" itemprop="url" rel="index"><span itemprop="name">SLAM</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>Review Lidar based SLAM algorithm and libraries</p>
<p>Some of the popular lib:</p>
<ul>
<li>LOAM</li>
<li><strong>LEGO LOAM</strong></li>
<li>LIO SAM</li>
</ul>
<h2 id="LOAM"><a href="#LOAM" class="headerlink" title="LOAM"></a>LOAM</h2><p>Year: 2014</p>
<p>Lidar Odometry and Mapping</p>
<ul>
<li>Scan Matching</li>
<li>Odometry</li>
<li>Fast and efficient</li>
</ul>
<p>Con:</p>
<ul>
<li>Require careful parameter tuning</li>
</ul>
<h2 id="LEGO-LOAM"><a href="#LEGO-LOAM" class="headerlink" title="LEGO LOAM"></a>LEGO LOAM</h2><p>Year: 2018</p>
<p>Lightweight and Ground-Optimized Lidar Odometry and Mapping</p>
<ul>
<li>Use line and point feature extraction to increase the robustness</li>
<li>More robust to sensor noise and calibration error</li>
</ul>
<h2 id="LIO-SAM"><a href="#LIO-SAM" class="headerlink" title="LIO SAM"></a>LIO SAM</h2><p>Year: 2018</p>
<p>Lidar Inertial Odometry and Mapping via Smoothing and Mapping</p>
<ul>
<li>Tightly couple with inertial sensor</li>
<li>Fuse sensor to estimate</li>
<li>Computation Intensive</li>
</ul>
<h2 id="LOCUS"><a href="#LOCUS" class="headerlink" title="LOCUS"></a>LOCUS</h2><p><a target="_blank" rel="noopener" href="https://github.com/NeBula-Autonomy/LOCUS">Repo</a></p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230306214826.gif" alt="locus-demo"></p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://www.aia-polytech.be/wp-content/uploads/2021/01/EvaluationAndComparisonOf3DLidarBasedSLAMAlgorithms.pdf">Evaluation and comparison of 3D lidar based SLAM algorithms</a></p>
<h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><ol>
<li>从一个开源项目到实际部署到机器人的过程中，有哪些要注意的地方</li>
<li>大概需要怎样的性能</li>
</ol>
<p>室内场景更加复杂</p>
<p>仓储机器人</p>
<p>激光雷达，传感器融合，</p>
<p>IMU: Bosch, ADA</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Math/Optmization/BFGS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Math/Optmization/BFGS/" class="post-title-link" itemprop="url">BFGS in Optimization</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-04 21:39:00" itemprop="dateCreated datePublished" datetime="2023-03-04T21:39:00-08:00">2023-03-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-27 23:00:31" itemprop="dateModified" datetime="2023-03-27T23:00:31-07:00">2023-03-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Math/" itemprop="url" rel="index"><span itemprop="name">Math</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Math/Optmization/" itemprop="url" rel="index"><span itemprop="name">Optmization</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p>Broyden-Fletcher-Goldfarb-Shanno</p>
<ul>
<li>Quasi-Newton optimization algorithm</li>
<li><strong>Gradient based</strong>: use first derivative of th objective function to improve the solution<ul>
<li>differnce of different algorithm: how to update the parameters<ul>
<li>first derivative</li>
<li>hessian matrix – BFGS</li>
</ul>
</li>
</ul>
</li>
<li>Maintain an approximation of the Hessian</li>
</ul>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><p>Find the minimum, the gradient is known or calculated<br>$$<br>B_{k+1} &#x3D; B_k + \frac{(\Delta \theta_k)(\Delta \theta_k)^T}{(\Delta \theta_k)^T \Delta g_k} - \frac{B_k \Delta g_k (\Delta g_k)^T B_k}{(\Delta g_k)^T B_k \Delta g_k}<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bfgs</span>(<span class="params">f, grad_f, x0, epsilon=<span class="number">1e-6</span>, max_iter=<span class="number">1000</span></span>):</span><br><span class="line">    n = <span class="built_in">len</span>(x0)</span><br><span class="line">    Bk = np.eye(n) <span class="comment"># initialize Hessian approximation</span></span><br><span class="line">    xk = x0</span><br><span class="line">    gk = grad_f(xk)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(max_iter):</span><br><span class="line">        <span class="keyword">if</span> np.linalg.norm(gk) &lt; epsilon:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        pk = -np.dot(Bk, gk)</span><br><span class="line">        alpha = backtracking_line_search(f, grad_f, xk, pk)</span><br><span class="line">        xk_next = xk + alpha*pk</span><br><span class="line">        sk = xk_next - xk</span><br><span class="line">        yk = grad_f(xk_next) - gk <span class="comment"># update the second order derivative</span></span><br><span class="line">        Bk_next = Bk + np.outer(yk, yk)/np.dot(yk, sk) - np.outer(np.dot(Bk, sk), np.dot(Bk, sk))/np.dot(sk, np.dot(Bk, sk))</span><br><span class="line">        xk, gk, Bk = xk_next, grad_f(xk_next), Bk_next</span><br><span class="line">    <span class="keyword">return</span> xk</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Broyden%E2%80%93Fletcher%E2%80%93Goldfarb%E2%80%93Shanno_algorithm">Wiki</a></p>
<p>ChatGPT</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Kinematics/trac-ik/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Kinematics/trac-ik/" class="post-title-link" itemprop="url">Trac-IK Paper Review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-03-04 20:58:21 / Modified: 23:08:17" itemprop="dateCreated datePublished" datetime="2023-03-04T20:58:21-08:00">2023-03-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Kinematics/" itemprop="url" rel="index"><span itemprop="name">Kinematics</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>In the paper, author compared some common open-source project address the kinematics problem. I want to know</p>
<ul>
<li>Which optimization method is used behind these popular project</li>
<li>How these project compared to each other</li>
</ul>
<h2 id="Introduciton"><a href="#Introduciton" class="headerlink" title="Introduciton"></a>Introduciton</h2><p>The main purpose if trac_ik is to improve the popular KDL</p>
<p>Issue with KDL</p>
<ul>
<li><p>convergence failure</p>
</li>
<li><p>stuck in local minima</p>
<ul>
<li>loop for maximum <strong>time</strong> rather than <strong>iteration</strong></li>
<li>Detect by $q_{next}-q_{prev}\approx 0$ <ul>
<li>Change to a random seed</li>
</ul>
</li>
</ul>
</li>
<li><p>Failure with joint limit</p>
<ul>
<li>solved with SQP sequential quadratic programming</li>
</ul>
</li>
<li><p>no utilization of tolerance</p>
</li>
</ul>
<h2 id="Candidate-IK-Algorithm"><a href="#Candidate-IK-Algorithm" class="headerlink" title="Candidate IK Algorithm"></a>Candidate IK Algorithm</h2><ul>
<li><p>KDL-RR</p>
<ul>
<li>Random Restart</li>
<li>maximum time</li>
</ul>
</li>
<li><p>SQP: SLSQP with BFGS<br>$$<br>\arg \min <em>{q \in \mathbf{R}^n}\left(q</em>{\text {seed }}-q\right)^T\left(q_{\text {seed }}-q\right),<br>$$</p>
</li>
<li><p>SQP-DQ: dual quaternion</p>
<ul>
<li><p>combine the translation and orientation</p>
</li>
<li><p>$$<br>\phi_{D Q}&#x3D;4\left((\log \hat{e}) \cdot(\log \hat{e})^T\right)<br>$$</p>
</li>
</ul>
</li>
<li><p>SQP-SS and SQP-L2, $p$ as simple 6-element vector</p>
<ul>
<li>SS: $\phi_{S S}&#x3D;p_{e r r} \cdot p_{e r r}^T$</li>
<li>L2: $\phi_{L 2}&#x3D;\sqrt{p_{e r r} \cdot p_{e r r}^T} .$</li>
</ul>
</li>
<li><p>Trac-ik</p>
<ul>
<li>Run two algorithm at once<ul>
<li>SQP-SS</li>
<li>KDL-RR</li>
</ul>
</li>
<li>Use the fastest one</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Kinematics/ik/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Kinematics/ik/" class="post-title-link" itemprop="url">Inverse Kinematics</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-02-28 22:36:21" itemprop="dateCreated datePublished" datetime="2023-02-28T22:36:21-08:00">2023-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-01 22:57:01" itemprop="dateModified" datetime="2023-03-01T22:57:01-08:00">2023-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Kinematics/" itemprop="url" rel="index"><span itemprop="name">Kinematics</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><p>Given a goal in world coordinates, should calculate the robot joint angle that end-effector would result in the desired goal</p>
<ul>
<li>Position</li>
<li>Orientation</li>
</ul>
<h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p><a target="_blank" rel="noopener" href="http://math.ucsd.edu/~sbuss/ResearchWeb/ikmethods/iksurvey.pdf">Ref</a></p>
<h3 id="Jacobian-Transpose"><a href="#Jacobian-Transpose" class="headerlink" title="Jacobian Transpose"></a>Jacobian Transpose</h3><p>Idea: Virtual force</p>
<p>How: Taking the transpose of Jacobian, multiplying by error, use the velocity to update the joint angle</p>
<p>Pro: fast, easy to implement</p>
<p>Con: lead to singularities, numerical instablity</p>
<h3 id="Pseudo-inverse-Jacobian"><a href="#Pseudo-inverse-Jacobian" class="headerlink" title="Pseudo-inverse Jacobian"></a>Pseudo-inverse Jacobian</h3><p>How: taking the pseudo-inverse of jacobian matrix, multiplying by error, use the velocity to update the joint angle</p>
<p>Pro: more robust than transpose</p>
<p>Con: result in larger joint velocity and longer convergence time</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">iteration=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    current_xyz=self.fk_lambda(current_angle)[:<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line">    error=np.linalg.norm(current_xyz-target_xyz)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> error&gt;threshold <span class="keyword">and</span> iteration&lt;max_iteration:</span><br><span class="line">        J=self.Jac(current_angle) <span class="comment">## get the jacobian matrix</span></span><br><span class="line">        delta_xyz=target_xyz-current_xyz <span class="comment">## get the error</span></span><br><span class="line">        </span><br><span class="line">        angle_delta=np.dot(J.T,delta_xyz) <span class="comment">## the key step</span></span><br><span class="line">        current_angle+=alpha*angle_delta <span class="comment">## update the joint angle</span></span><br><span class="line">        current_xyz=self.fk_lambda(current_angle)[:<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line">        error=np.linalg.norm(current_xyz-target_xyz)</span><br><span class="line">        iteration+=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="Damped-Least-Square"><a href="#Damped-Least-Square" class="headerlink" title="Damped Least Square"></a>Damped Least Square</h3><p>How: adding a damping factor to the pseudo-inverse method</p>
<p>Pro: improved stability and convergence</p>
<p>Con: more computationally intensive</p>
<h3 id="Optimization-Based"><a href="#Optimization-Based" class="headerlink" title="Optimization Based"></a>Optimization Based</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">joint_limits=np.zeros((<span class="number">7</span>,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        joint_limits[i,<span class="number">0</span>]=self.joint_list[i][<span class="string">&#x27;bounds&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">        joint_limits[i,<span class="number">1</span>]=self.joint_list[i][<span class="string">&#x27;bounds&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">objective_function</span>(<span class="params">joint_angle</span>):</span><br><span class="line">        current_xyz=self.fk_lambda(joint_angle)[:<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line">        error=np.linalg.norm(current_xyz-target_xyz)</span><br><span class="line">        <span class="comment"># print(error)</span></span><br><span class="line">        <span class="keyword">return</span> error</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inequality_constraint</span>(<span class="params">joint_angle</span>):</span><br><span class="line">        ineq= np.concatenate((joint_angle[:<span class="number">6</span>] -joint_limits[:<span class="number">6</span>,<span class="number">0</span>], joint_limits[:<span class="number">6</span>, <span class="number">1</span>] - joint_angle[:<span class="number">6</span>])).flatten()</span><br><span class="line">        <span class="comment"># print(ineq.shape)</span></span><br><span class="line">        <span class="keyword">return</span> ineq</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">equality_constraint</span>(<span class="params">joint_angle</span>):</span><br><span class="line">        current_xyz=self.fk_lambda(joint_angle)[:<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line">        error=current_xyz-target_xyz</span><br><span class="line">        <span class="keyword">return</span> error</span><br><span class="line">    cons = [</span><br><span class="line">           &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;ineq&#x27;</span>, <span class="string">&#x27;fun&#x27;</span>: inequality_constraint&#125;]</span><br><span class="line">    <span class="comment"># cons=[</span></span><br><span class="line">    <span class="comment">#     NonlinearConstraint(equality_constraint,0,0)</span></span><br><span class="line">    <span class="comment"># ]</span></span><br><span class="line">    result = minimize(objective_function, current_angle, method=<span class="string">&#x27;SLSQP&#x27;</span>, tol=<span class="number">1e-6</span>,constraints=<span class="literal">None</span>, options=&#123;<span class="string">&#x27;disp&#x27;</span>: <span class="literal">True</span>,<span class="string">&#x27;maxiter&#x27;</span>:<span class="number">1000</span>&#125;)</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Kinematics/jacobian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Kinematics/jacobian/" class="post-title-link" itemprop="url">Jacobian Matrix for Robot Arm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-02-27 19:36:21 / Modified: 20:52:15" itemprop="dateCreated datePublished" datetime="2023-02-27T19:36:21-08:00">2023-02-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Kinematics/" itemprop="url" rel="index"><span itemprop="name">Kinematics</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="What-is-Jacobian-Matrix"><a href="#What-is-Jacobian-Matrix" class="headerlink" title="What is Jacobian Matrix"></a>What is Jacobian Matrix</h2><p>The Jacobian matrix is a matrix of partial derivatives that describes the rate of change of a system with respect to its variables. In other words, it relates the <strong>change in inpu</strong>t variables to the <strong>change in output variables</strong>. The Jacobian matrix is commonly used in multivariable calculus and in the fields of physics, engineering, and robotics.</p>
<p>For example, consider a robotic arm with n degrees of freedom. The state of the robot can be described by a set of joint angles q &#x3D; (q1, q2, …, qn), and the position of the end-effector can be described by a vector x &#x3D; (x, y, z). The Jacobian matrix J relates the joint angles to the end-effector position:<br>$$<br>\frac{\partial x}{\partial q_1} &amp; \frac{\partial x}{\partial q_2} &amp; \cdots &amp; \frac{\partial x}{\partial q_n}\<br>\frac{\partial y}{\partial q_1} &amp; \frac{\partial y}{\partial q_2} &amp; \cdots &amp; \frac{\partial y}{\partial q_n}\<br>\frac{\partial z}{\partial q_1} &amp; \frac{\partial z}{\partial q_2} &amp; \cdots &amp; \frac{\partial z}{\partial q_n}<br>$$</p>
<h2 id="Jacobian-for-Robot-Arm"><a href="#Jacobian-for-Robot-Arm" class="headerlink" title="Jacobian for Robot Arm"></a>Jacobian for Robot Arm</h2><p>In robotics, the Jacobian matrix is used to calculate the end-effector velocity given the joint velocities. This is important for controlling the motion of a robotic arm, as it allows us to <strong>determine the joint velocities required to achieve a desired end-effector velocity</strong>. </p>
<p>To calculate the Jacobian matrix for a robotic arm, we need to know the kinematic structure of the arm. This can be described using a URDF (Unified Robot Description Format) file, which defines the joint types, joint limits, and link lengths of the arm. Once we have the URDF file, we can derive the jacobian matrix mannauly</p>
<h2 id="Jacobian-for-Inverse-Kinematics"><a href="#Jacobian-for-Inverse-Kinematics" class="headerlink" title="Jacobian for Inverse Kinematics"></a>Jacobian for Inverse Kinematics</h2><p>Inverse kinematics is a challenging problem in robotics, as it requires solving a system of <strong>non-linear equations</strong>. </p>
<p>The Jacobian matrix can be used to solve this problem by providing a linear approximation of the relationship between the joint angles and end-effector position. Specifically, we can use the Jacobian transpose to convert the desired end-effector velocity into joint velocities:</p>
<p>$$\dot{q} &#x3D; J^T(x) \cdot \dot{x}$$ where $\dot{q}$ is the joint velocity, $\dot{x}$ is the desired end-effector velocity, and $J^T$ is the transpose of the Jacobian matrix. By iteratively updating the joint angles using the calculated joint velocities, we can converge to a solution that achieves the desired end-effector position.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hujunhan.github.io/MarkdownNotes/Robotics/Planning/arm-path/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Junhan Hu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Only Truth Matters">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/MarkdownNotes/Robotics/Planning/arm-path/" class="post-title-link" itemprop="url">Path Planning for Robot Arm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-02-26 15:41:00 / Modified: 18:16:53" itemprop="dateCreated datePublished" datetime="2023-02-26T15:41:00-08:00">2023-02-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/" itemprop="url" rel="index"><span itemprop="name">MarkdownNotes</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/" itemprop="url" rel="index"><span itemprop="name">Robotics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MarkdownNotes/Robotics/Planning/" itemprop="url" rel="index"><span itemprop="name">Planning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Math-Formulation"><a href="#Math-Formulation" class="headerlink" title="Math Formulation"></a>Math Formulation</h2><p>目标：生成一条符合<strong>要求</strong>的轨迹（<strong>点</strong>的集合）</p>
<ul>
<li>目标是根据需求来选择的，一般的会有的需求</li>
<li>时间</li>
<li>joint constraints</li>
<li>避障</li>
<li>点：在三维空间中</li>
</ul>
<h2 id="Library"><a href="#Library" class="headerlink" title="Library"></a>Library</h2><p>OMPL (Open Motion Planning Library)</p>
<ul>
<li>sampling based and optimization based</li>
<li>How: PRM (Probabilistic Roadmaps ), RRT, BIT( Batch Informed Trees)</li>
<li>Input: include the robot’s configuration, the environment</li>
<li>Output: the motion plan, a sequence of robot configuration or trajectories</li>
</ul>
<p>PIMPL (Pilz Industrial Motion Planner)</p>
<ul>
<li>especially designed for industrial robot</li>
</ul>
<p>STOMP (Stochastic Trajectory Optimization for Motion Planning)</p>
<ul>
<li>optimization based, suited for many degree of freedoms</li>
<li>How: iteratively optimizing a random trajectories</li>
</ul>
<p>SBPL (Search-Based Planning Library )</p>
<ul>
<li>search based</li>
<li>How: reprensent the robot and environment as a grid, then use search algorithm like A*, Dijkstra, to explore</li>
</ul>
<p>CHOMP (Covariant Hamiltonian Optimization for Motion Planning )</p>
<ul>
<li>optimization based</li>
<li>How:  based on the Hamiltonian formulation of mechanics and optimizes the Hamiltonian of the system subject to constraints.</li>
</ul>
<h2 id="Math-Basis"><a href="#Math-Basis" class="headerlink" title="Math Basis"></a>Math Basis</h2><p>RPM, RRT, BIT, Search, Optmization</p>
<h3 id="Cell-Decomposition"><a href="#Cell-Decomposition" class="headerlink" title="Cell Decomposition"></a>Cell Decomposition</h3><p>Sample the space into grid, so the problem degrade to a classic search problem</p>
<ul>
<li>Bad for high-dimensional situation</li>
</ul>
<h3 id="Control-based"><a href="#Control-based" class="headerlink" title="Control based"></a>Control based</h3><ul>
<li>Fast, can be done in online with minimal error</li>
<li>Difficult to compute with  complex dynamics</li>
</ul>
<h3 id="Potential-Fields"><a href="#Potential-Fields" class="headerlink" title="Potential Fields"></a>Potential Fields</h3><p>Simple and intuitive</p>
<ul>
<li>Real time speed</li>
<li>Fail in local minima</li>
</ul>
<h3 id="Sample-Based"><a href="#Sample-Based" class="headerlink" title="Sample Based"></a>Sample Based</h3><ul>
<li>If the solution exist, the method would find it</li>
</ul>
<p>Some idea: workspace, state space, free state space, ppath</p>
<p>Two type</p>
<ul>
<li><p>PRM, Using the knowdege of graph</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230226181351.png" alt="image-20230226181351316"></p>
</li>
<li><p>Tree based</p>
<p><img src="https://raw.githubusercontent.com/hujunhan/cloudimage/master/img/20230226181414.png" alt="image-20230226181414617"></p>
</li>
</ul>
<p>Important tool</p>
<ul>
<li>Collision checking</li>
<li>Nearest neighbor</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Junhan Hu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">313</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">112</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hujunhan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hujunhan" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hujunhan98@outlook.com" title="E-Mail → mailto:hujunhan98@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junhan Hu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
